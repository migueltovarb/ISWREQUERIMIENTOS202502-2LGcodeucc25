{% extends "cafeteria/base.html" %}
{% block content %}
<div class="container mt-4">
	<div class="col-lg-7 mx-auto">
		<div class="card card-custom">
			<div class="text-center mb-3">
				<span style="font-size:58px;color:#198754;">
					<i class="bi bi-check-circle-fill"></i>
				</span>
			</div>
			<h2 class="fw-bold text-center mb-2">Pago Confirmado</h2>
			<p class="text-muted text-center mb-4">Tu pago del pedido <strong>#{{ pedido.id }}</strong> fue procesado correctamente.</p>

			<div class="row g-3 mb-3">
				<div class="col-md-6">
					<div class="p-3 rounded border bg-light h-100">
						<h6 class="fw-bold mb-2">Resumen del Pedido</h6>
						<p class="mb-1"><strong>Cliente:</strong> {{ request.user.username }}</p>
						<p class="mb-1"><strong>Total:</strong> ${{ pedido.total }}</p>
						<p class="mb-1"><strong>Estado:</strong>
							<span class="badge {% if pedido.estado == 'pendiente' %}bg-warning text-dark{% elif pedido.estado == 'preparacion' %}bg-primary{% elif pedido.estado == 'listo' %}bg-success{% elif pedido.estado == 'entregado' %}bg-secondary{% endif %}">
								{{ pedido.estado|capfirst }}
							</span>
						</p>
						{% if pedido.promocion_aplicada %}
						<p class="text-success mb-0"><i class="bi bi-tag-fill"></i> Promo: <strong>{{ pedido.promocion_aplicada.nombre }}</strong></p>
						{% endif %}
					</div>
				</div>
				<div class="col-md-6">
					<div class="p-3 rounded border bg-light h-100">
						<h6 class="fw-bold mb-2">Datos del Pago</h6>
						{% if pago %}
							<p class="mb-1"><strong>Método:</strong> {{ pago.get_metodo_display }}</p>
							<p class="mb-1"><strong>Referencia:</strong> {{ pago.referencia|default:"—" }}</p>
							<p class="mb-1"><strong>Fecha:</strong> {{ pago.fecha_pago|date:"d/m/Y H:i" }}</p>
							<span class="badge bg-success">Pagado</span>
						{% else %}
							<p class="text-danger mb-0">No se encontró información de pago.</p>
						{% endif %}
					</div>
				</div>
			</div>

			<div class="mb-4">
				<h6 class="fw-bold mb-3">Siguiente Paso</h6>
				<ol class="list-group list-group-numbered">
					<li class="list-group-item small">Tu pedido entra en cola de preparación.</li>
					<li class="list-group-item small">Recibirás estado: Preparación → Listo.</li>
					<li class="list-group-item small">Recoge en ventanilla mostrando el número #{{ pedido.id }}.</li>
				</ol>
			</div>

			<div class="d-flex flex-column flex-md-row gap-3">
				<a href="{% url 'estado_pedidos' %}" class="btn btn-primary w-100"><i class="bi bi-list-ul"></i> Ver mis pedidos</a>
				<a href="{% url 'crear_pedido_autoservicio' %}" class="btn btn-outline-primary w-100"><i class="bi bi-plus-circle"></i> Nuevo pedido</a>
				<a href="{% url 'menu' %}" class="btn btn-outline-secondary w-100"><i class="bi bi-egg-fried"></i> Volver al menú</a>
			</div>
		</div>
	</div>
</div>
{% endblock %}
